<h1>Java#index</h1>
<p>Find me in app/views/java/index.html.erb</p>

<p>JS練習 Step1</p>
  <button id="btn">クリックしてみよう</button>
  <p id="msg">まだ押されていません</p>

  <script>
    // Step 1. 要素を取得する
    const btn = document.getElementById("btn")
    const msg = document.getElementById("msg")

    // Step 2. ボタンがクリックされたときに実行する処理を登録
    btn.addEventListener("click", () => {
      // Step 3. テキストを書き換える
      if (msg.textContent === "まだ押されていません"){
        msg.textContent = "クリックされました！"
        msg.style.color = "red"
      } else {
        msg.textContent = "まだ押されていません"
        msg.style.color = "black"
      }
    })
  </script>

  <p>JS練習 Step2</p>
  <button id="toggle-btn">メッセージを表示 / 非表示</button>
  <p id="message" class="text-red-600">こんにちは!JavaScriptを使いこなそう!</p>

  <script>
    const btn1 = document.getElementById("toggle-btn");
    const message = document.getElementById("message");

    btn1.addEventListener("click", (e) => {
      // e.preventDefault(); // ← form内なら有効化
      message.classList.toggle("hidden");

      if ( message.classList.contains("hidden") ) {
        btn1.textContent = "メッセージを表示"
      } else {
        btn1.textContent = "メッセージを非表示"
      }
    });
  </script>


  <p>JS練習 Step3</p>

  <button id="open-btn">ボックスを表示</button>

  <div id="box" class="box hidden">
    <p>ここがボックスの中です</p>
    <button id="inside-btn">中のボタン</button>
  </div>

  <script>
    const openBtn1 = document.getElementById("open-btn")
    const box = document.getElementById("box")

    // ボタンを押したら表示
    openBtn1.addEventListener("click", (e) => {
      console.log(e)
      e.stopPropagation() // ← 自分のクリックを外側判定にしない
      box.classList.remove("hidden")
    })

    // 外側クリックを検知
    document.addEventListener("click", (e) => {
      // boxの中をクリックしたなら閉じない
      if (!box.contains(e.target)) {
        box.classList.add("hidden")
      }
    })

    // 中のボタンはクリックしても閉じない（確認用）
    const insideBtn = document.getElementById("inside-btn")
    insideBtn.addEventListener("click", (e) => {
      // e.stopPropagation()
      alert("中のボタンがクリックされました！")
    })
  </script>


<!--ーーーーーーーーーーーーここからStep4ーーーーーーーーーーーーーーー-->

  <p>JS練習 Step4</p>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const openBtn  = document.getElementById("open-modal")
      const overlay  = document.getElementById("overlay")
      const modal    = document.getElementById("modal")
      const closeBtn = document.getElementById("close-modal")

      const openModal = (e) => {
        e.stopPropagation()                 // 外側クリック扱いにさせない
        overlay.classList.remove("hidden")  // 黒背景の表示
        modal.classList.remove("hidden")    // モーダルの表示

        // 外側クリックで閉じる（開いている間だけ監視）
        document.addEventListener("click", onDocClick)
        // Escで閉じる（開いている間だけ監視）
        document.addEventListener("keydown", onEsc)
      }

      const closeModal = () => {
        overlay.classList.add("hidden")     // 非表示
        modal.classList.add("hidden")
        // 監視解除（後片付け）
        document.removeEventListener("click", onDocClick)
        document.removeEventListener("keydown", onEsc)
      }

      // 外側クリック判定：overlayは外側、modalは内側
      const onDocClick = (e) => {
        const clickedInside = modal.contains(e.target)
        if (!clickedInside) closeModal()
      }

      // Escキーで閉じる
      const onEsc = (e) => {
        if (e.key === "Escape") closeModal()
      }

      // イベント登録
      openBtn.addEventListener("click", openModal)
      closeBtn.addEventListener("click", (e) => {
        // e.stopPropagation()
        closeModal()
      })

      // 必要ないのでは？
      // モーダル内クリックは外側扱いにしない（重要）
      // modal.addEventListener("click", (e) => e.stopPropagation())
    })
  </script>

  <button id="open-modal" class="px-4 py-2 rounded bg-blue-600 text-white">
    モーダルを開く
  </button>

  <!-- オーバーレイ（外側クリック判定の“外側”） -->
  <div id="overlay"
      class="hidden fixed inset-0 bg-black/40">

  <!-- モーダル本体（“内側”） -->
    <div id="modal" class="hidden grid place-items-center mt-4 z-50">
      <div class="w-[90%] max-w-md rounded-xl bg-white p-6 shadow-xl">
        <h2 class="text-lg font-bold mb-3">モーダルの見出し</h2>
        <p class="mb-6">ここがボックスの中です。外側をクリック or Esc で閉じます。</p>
        <div class="flex justify-end gap-2">
          <button id="close-modal" class="px-3 py-2 rounded bg-gray-200">閉じる</button>
          <button class="px-3 py-2 rounded bg-blue-600 text-white"
                  onclick="alert('中のボタンがクリックされました！')">
            中のボタン
          </button>
        </div>
      </div>
    </div>
  </div>